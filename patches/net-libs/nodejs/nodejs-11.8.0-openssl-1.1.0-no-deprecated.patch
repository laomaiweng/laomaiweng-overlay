diff --git a/src/node_crypto.cc b/src/node_crypto.cc
index 6b604bf..9358c14 100644
--- a/src/node_crypto.cc
+++ b/src/node_crypto.cc
@@ -41,6 +41,10 @@
 #include <limits.h>  // INT_MAX
 #include <string.h>
 
+#include <openssl/bn.h>
+#include <openssl/dh.h>
+#include <openssl/rsa.h>
+
 #include <algorithm>
 #include <memory>
 #include <utility>
@@ -1734,7 +1738,11 @@ static Local<Object> X509ToObject(Environment* env, X509* cert) {
   rsa.reset();
   ec.reset();
 
+#if OPENSSL_VERSION_NUMBER < 0x10100000L
   ASN1_TIME_print(bio.get(), X509_get_notBefore(cert));
+#else
+  ASN1_TIME_print(bio.get(), X509_get0_notBefore(cert));
+#endif
   BIO_get_mem_ptr(bio.get(), &mem);
   info->Set(context, env->valid_from_string(),
             String::NewFromUtf8(env->isolate(), mem->data,
@@ -1742,7 +1750,11 @@ static Local<Object> X509ToObject(Environment* env, X509* cert) {
                                 mem->length).ToLocalChecked()).FromJust();
   USE(BIO_reset(bio.get()));
 
+#if OPENSSL_VERSION_NUMBER < 0x10100000L
   ASN1_TIME_print(bio.get(), X509_get_notAfter(cert));
+#else
+  ASN1_TIME_print(bio.get(), X509_get0_notAfter(cert));
+#endif
   BIO_get_mem_ptr(bio.get(), &mem);
   info->Set(context, env->valid_to_string(),
             String::NewFromUtf8(env->isolate(), mem->data,
@@ -6154,8 +6166,13 @@ void TimingSafeEqual(const FunctionCallbackInfo<Value>& args) {
 }
 
 void InitCryptoOnce() {
+#if OPENSSL_VERSION_NUMBER < 0x10100000L
   SSL_load_error_strings();
   OPENSSL_no_config();
+#else
+  OPENSSL_init_ssl(OPENSSL_INIT_LOAD_CRYPTO_STRINGS | OPENSSL_INIT_LOAD_SSL_STRINGS
+                   | OPENSSL_INIT_NO_LOAD_CONFIG, NULL);
+#endif
 
   // --openssl-config=...
   if (!per_process::cli_options->openssl_config.empty()) {
@@ -6176,8 +6193,12 @@ void InitCryptoOnce() {
     }
   }
 
+#if OPENSSL_VERSION_NUMBER < 0x10100000L
   SSL_library_init();
   OpenSSL_add_all_algorithms();
+#else
+  OPENSSL_init_ssl(OPENSSL_INIT_ADD_ALL_CIPHERS | OPENSSL_INIT_ADD_ALL_DIGESTS, NULL);
+#endif
 
 #ifdef NODE_FIPS_MODE
   /* Override FIPS settings in cnf file, if needed. */
diff --git a/src/node_crypto.h b/src/node_crypto.h
index 1b95084..d89c4d6 100644
--- a/src/node_crypto.h
+++ b/src/node_crypto.h
@@ -52,6 +52,10 @@
 #include <openssl/hmac.h>
 #include <openssl/rand.h>
 #include <openssl/pkcs12.h>
+#include <openssl/dh.h>
+#include <openssl/rsa.h>
+#include <openssl/dsa.h>
+#include <openssl/bn.h>
 
 namespace node {
 namespace crypto {
