diff --git a/src/_cffi_src/openssl/asn1.py b/src/_cffi_src/openssl/asn1.py
index 82bf797..d516ea0 100644
--- a/src/_cffi_src/openssl/asn1.py
+++ b/src/_cffi_src/openssl/asn1.py
@@ -103,4 +103,7 @@ ASN1_NULL *ASN1_NULL_new(void);
 """
 
 CUSTOMIZATIONS = """
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define ASN1_STRING_data ASN1_STRING_get0_data
+#endif
 """
diff --git a/src/_cffi_src/openssl/bignum.py b/src/_cffi_src/openssl/bignum.py
index a352f5a..b282030 100644
--- a/src/_cffi_src/openssl/bignum.py
+++ b/src/_cffi_src/openssl/bignum.py
@@ -81,4 +81,8 @@ const int BN_prime_checks_for_size(int);
 """
 
 CUSTOMIZATIONS = """
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#undef BN_zero
+#define BN_zero(x) (0)
+#endif
 """
diff --git a/src/_cffi_src/openssl/callbacks.py b/src/_cffi_src/openssl/callbacks.py
index 75c6201..5e5ab2a 100644
--- a/src/_cffi_src/openssl/callbacks.py
+++ b/src/_cffi_src/openssl/callbacks.py
@@ -121,6 +121,7 @@ static void init_mutexes(void) {
 
 
 int Cryptography_setup_ssl_threads(void) {
+#if OPENSSL_API_COMPAT < 0x10100000L
     if (_ssl_locks == NULL) {
         _ssl_locks_count = CRYPTO_num_locks();
         _ssl_locks = calloc(_ssl_locks_count, sizeof(Cryptography_mutex));
@@ -133,6 +134,7 @@ int Cryptography_setup_ssl_threads(void) {
         pthread_atfork(NULL, NULL, &init_mutexes);
 #endif
     }
+#endif
     return 1;
 }
 #else
diff --git a/src/_cffi_src/openssl/conf.py b/src/_cffi_src/openssl/conf.py
index 9db0162..4eae213 100644
--- a/src/_cffi_src/openssl/conf.py
+++ b/src/_cffi_src/openssl/conf.py
@@ -18,4 +18,9 @@ void OPENSSL_no_config(void);
 """
 
 CUSTOMIZATIONS = """
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define OPENSSL_config(n) CONF_modules_load(NULL,n,0)
+#define OPENSSL_no_config() \
+    OPENSSL_init_crypto(OPENSSL_INIT_NO_LOAD_CONFIG, NULL)
+#endif
 """
diff --git a/src/_cffi_src/openssl/crypto.py b/src/_cffi_src/openssl/crypto.py
index 03672d5..230d216 100644
--- a/src/_cffi_src/openssl/crypto.py
+++ b/src/_cffi_src/openssl/crypto.py
@@ -140,6 +140,16 @@ int Cryptography_CRYPTO_set_mem_functions(
 }
 #endif
 
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define ASN1_STRING_data ASN1_STRING_get0_data
+#define CRYPTO_cleanup_all_ex_data() while(0) continue
+#define CRYPTO_num_locks()            (1)
+#define CRYPTO_set_locking_callback(func)
+#define CRYPTO_get_locking_callback()         (NULL)
+#define CRYPTO_set_add_lock_callback(func)
+#define CRYPTO_get_add_lock_callback()        (NULL)
+#endif
+
 void *Cryptography_malloc_wrapper(size_t size, const char *path, int line) {
     return malloc(size);
 }
diff --git a/src/_cffi_src/openssl/engine.py b/src/_cffi_src/openssl/engine.py
index 45ce952..de1a549 100644
--- a/src/_cffi_src/openssl/engine.py
+++ b/src/_cffi_src/openssl/engine.py
@@ -130,4 +130,30 @@ void ENGINE_cleanup(void);
 """
 
 CUSTOMIZATIONS = """
+#if OPENSSL_API_COMPAT >= 0x10100000L
+/*
+ * This function previously cleaned up anything that needs it. Auto-deinit will
+ * now take care of it so it is no longer required to call this function.
+ */
+# define ENGINE_cleanup() while(0) continue
+#endif
+
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define ENGINE_load_openssl() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ENGINE_OPENSSL, NULL)
+#define ENGINE_load_dynamic() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ENGINE_DYNAMIC, NULL)
+#ifndef OPENSSL_NO_STATIC_ENGINE
+#define ENGINE_load_padlock() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ENGINE_PADLOCK, NULL)
+#define ENGINE_load_capi() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ENGINE_CAPI, NULL)
+#define ENGINE_load_afalg() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ENGINE_AFALG, NULL)
+#endif
+#define ENGINE_load_cryptodev() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ENGINE_CRYPTODEV, NULL)
+#define ENGINE_load_rdrand() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ENGINE_RDRAND, NULL)
+#endif
 """
diff --git a/src/_cffi_src/openssl/err.py b/src/_cffi_src/openssl/err.py
index d4033f5..7df524f 100644
--- a/src/_cffi_src/openssl/err.py
+++ b/src/_cffi_src/openssl/err.py
@@ -179,4 +179,10 @@ static const long Cryptography_HAS_EVP_R_MEMORY_LIMIT_EXCEEDED = 1;
 static const long EVP_R_MEMORY_LIMIT_EXCEEDED = 0;
 static const long Cryptography_HAS_EVP_R_MEMORY_LIMIT_EXCEEDED = 0;
 #endif
+
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define ERR_load_crypto_strings() \
+    OPENSSL_init_crypto(OPENSSL_INIT_LOAD_CRYPTO_STRINGS, NULL)
+#define ERR_free_strings() while(0) continue
+#endif
 """
diff --git a/src/_cffi_src/openssl/evp.py b/src/_cffi_src/openssl/evp.py
index 9ae6025..0c7a276 100644
--- a/src/_cffi_src/openssl/evp.py
+++ b/src/_cffi_src/openssl/evp.py
@@ -317,4 +317,37 @@ static const long Cryptography_HAS_EVP_DIGESTFINAL_XOF = 1;
 #ifndef EVP_PKEY_ED448
 #define EVP_PKEY_ED448 NID_ED448
 #endif
+
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define EVP_CIPHER_CTX_init(c)      EVP_CIPHER_CTX_reset(c)
+#define EVP_CIPHER_CTX_cleanup(c)   EVP_CIPHER_CTX_reset(c)
+#endif
+
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define OPENSSL_add_all_algorithms_conf() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ADD_ALL_CIPHERS \
+                        | OPENSSL_INIT_ADD_ALL_DIGESTS \
+                        | OPENSSL_INIT_LOAD_CONFIG, NULL)
+#define OPENSSL_add_all_algorithms_noconf() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ADD_ALL_CIPHERS \
+                        | OPENSSL_INIT_ADD_ALL_DIGESTS, NULL)
+
+#ifdef OPENSSL_LOAD_CONF
+#define OpenSSL_add_all_algorithms() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ADD_ALL_CIPHERS \
+                        | OPENSSL_INIT_ADD_ALL_DIGESTS \
+                        | OPENSSL_INIT_LOAD_CONFIG, NULL)
+#else
+#define OpenSSL_add_all_algorithms() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ADD_ALL_CIPHERS \
+                        | OPENSSL_INIT_ADD_ALL_DIGESTS, NULL)
+#endif
+
+#define OpenSSL_add_all_ciphers() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ADD_ALL_CIPHERS, NULL)
+#define OpenSSL_add_all_digests() \
+    OPENSSL_init_crypto(OPENSSL_INIT_ADD_ALL_DIGESTS, NULL)
+
+#define EVP_cleanup() while(0) continue
+#endif
 """
diff --git a/src/_cffi_src/openssl/objects.py b/src/_cffi_src/openssl/objects.py
index 265ac75..7e9c82a 100644
--- a/src/_cffi_src/openssl/objects.py
+++ b/src/_cffi_src/openssl/objects.py
@@ -38,4 +38,7 @@ void OBJ_cleanup(void);
 """
 
 CUSTOMIZATIONS = """
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define OBJ_cleanup() while(0) continue
+#endif
 """
diff --git a/src/_cffi_src/openssl/rand.py b/src/_cffi_src/openssl/rand.py
index 6865392..5955189 100644
--- a/src/_cffi_src/openssl/rand.py
+++ b/src/_cffi_src/openssl/rand.py
@@ -28,4 +28,8 @@ void RAND_cleanup(void);
 
 CUSTOMIZATIONS = """
 static const long Cryptography_HAS_EGD = 0;
+
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define RAND_cleanup() while(0) continue
+#endif
 """
diff --git a/src/_cffi_src/openssl/ssl.py b/src/_cffi_src/openssl/ssl.py
index 2218095..3ccbbdb 100644
--- a/src/_cffi_src/openssl/ssl.py
+++ b/src/_cffi_src/openssl/ssl.py
@@ -849,4 +849,151 @@ int (*SSL_CTX_set_max_early_data)(SSL_CTX *, uint32_t) = NULL;
 #else
 static const long Cryptography_HAS_TLSv1_3 = 1;
 #endif
+
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define SSL_library_init() OPENSSL_init_ssl(0, NULL)
+#define SSL_load_error_strings() \
+    OPENSSL_init_ssl(OPENSSL_INIT_LOAD_SSL_STRINGS \
+                     | OPENSSL_INIT_LOAD_CRYPTO_STRINGS, NULL)
+
+static void _set_protocol_version(const SSL_METHOD *m, int version)
+{
+    SSL_CTX *ctx = SSL_CTX_new(m);
+    SSL_CTX_set_min_proto_version(ctx, version);
+    SSL_CTX_set_max_proto_version(ctx, version);
+    SSL_CTX_free(ctx);
+}
+
+/*
+ * TLSv1_1 and TLSv1_2 are recent additions.  Only sufficiently new versions of
+ * OpenSSL support them.
+ */
+const SSL_METHOD *Cryptography_TLSv1_1_method(void)
+{
+    const SSL_METHOD *m = TLS_method();
+    _set_protocol_version(m, TLS1_1_VERSION);
+    return m;
+}
+
+const SSL_METHOD *Cryptography_TLSv1_1_server_method(void)
+{
+    const SSL_METHOD *m = TLS_server_method();
+    _set_protocol_version(m, TLS1_1_VERSION);
+    return m;
+}
+
+const SSL_METHOD *Cryptography_TLSv1_1_client_method(void)
+{
+    const SSL_METHOD *m = TLS_client_method();
+    _set_protocol_version(m, TLS1_1_VERSION);
+    return m;
+}
+
+const SSL_METHOD *Cryptography_TLSv1_2_method(void)
+{
+    const SSL_METHOD *m = TLS_method();
+    _set_protocol_version(m, TLS1_2_VERSION);
+    return m;
+}
+
+const SSL_METHOD *Cryptography_TLSv1_2_server_method(void)
+{
+    const SSL_METHOD *m = TLS_server_method();
+    _set_protocol_version(m, TLS1_2_VERSION);
+    return m;
+}
+
+const SSL_METHOD *Cryptography_TLSv1_2_client_method(void)
+{
+    const SSL_METHOD *m = TLS_client_method();
+    _set_protocol_version(m, TLS1_2_VERSION);
+    return m;
+}
+
+#define TLSv1_1_method Cryptography_TLSv1_1_method
+#define TLSv1_1_server_method Cryptography_TLSv1_1_server_method
+#define TLSv1_1_client_method Cryptography_TLSv1_1_client_method
+#define TLSv1_2_method Cryptography_TLSv1_2_method
+#define TLSv1_2_server_method Cryptography_TLSv1_2_server_method
+#define TLSv1_2_client_method Cryptography_TLSv1_2_client_method
+
+#ifndef OPENSSL_NO_SSL3_METHOD
+const SSL_METHOD *Cryptography_SSLv3_method(void)
+{
+    const SSL_METHOD *m = TLS_method();
+    _set_protocol_version(m, SSL3_VERSION);
+    return m;
+}
+
+const SSL_METHOD *Cryptography_SSLv3_server_method(void)
+{
+    const SSL_METHOD *m = TLS_server_method();
+    _set_protocol_version(m, SSL3_VERSION);
+    return m;
+}
+
+const SSL_METHOD *Cryptography_SSLv3_client_method(void)
+{
+    const SSL_METHOD *m = TLS_client_method();
+    _set_protocol_version(m, SSL3_VERSION);
+    return m;
+}
+
+#define SSLv3_method Cryptography_SSLv3_method
+#define SSLv3_server_method Cryptography_SSLv3_server_method
+#define SSLv3_client_method Cryptography_SSLv3_client_method
+#endif
+
+const SSL_METHOD *Cryptography_TLSv1_method(void)
+{
+    const SSL_METHOD *m = TLS_method();
+    _set_protocol_version(m, TLS1_VERSION);
+    return m;
+}
+
+const SSL_METHOD *Cryptography_TLSv1_server_method(void)
+{
+    const SSL_METHOD *m = TLS_server_method();
+    _set_protocol_version(m, TLS1_VERSION);
+    return m;
+}
+
+const SSL_METHOD *Cryptography_TLSv1_client_method(void)
+{
+    const SSL_METHOD *m = TLS_client_method();
+    _set_protocol_version(m, TLS1_VERSION);
+    return m;
+}
+
+#define TLSv1_method Cryptography_TLSv1_method
+#define TLSv1_server_method Cryptography_TLSv1_server_method
+#define TLSv1_client_method Cryptography_TLSv1_client_method
+
+#if !defined(OPENSSL_NO_DTLS) && !CRYPTOGRAPHY_OPENSSL_LESS_THAN_102
+const SSL_METHOD *Cryptography_DTLSv1_method(void)
+{
+    const SSL_METHOD *m = TLS_method();
+    _set_protocol_version(m, DTLS1_VERSION);
+    return m;
+}
+
+const SSL_METHOD *Cryptography_DTLSv1_server_method(void)
+{
+    const SSL_METHOD *m = TLS_server_method();
+    _set_protocol_version(m, DTLS1_VERSION);
+    return m;
+}
+
+const SSL_METHOD *Cryptography_DTLSv1_client_method(void)
+{
+    const SSL_METHOD *m = TLS_client_method();
+    _set_protocol_version(m, DTLS1_VERSION);
+    return m;
+}
+
+#define DTLSv1_method Cryptography_DTLSv1_method
+#define DTLSv1_server_method Cryptography_DTLSv1_server_method
+#define DTLSv1_client_method Cryptography_DTLSv1_client_method
+#endif
+#endif
 """
diff --git a/src/_cffi_src/openssl/x509.py b/src/_cffi_src/openssl/x509.py
index 748c6c8..5e0d575 100644
--- a/src/_cffi_src/openssl/x509.py
+++ b/src/_cffi_src/openssl/x509.py
@@ -439,4 +439,15 @@ const ASN1_INTEGER *X509_REVOKED_get0_serialNumber(const X509_REVOKED *x)
 }
 #endif
 #endif
+
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define X509_get_notBefore X509_getm_notBefore
+#define X509_get_notAfter X509_getm_notAfter
+#define X509_set_notBefore X509_set1_notBefore
+#define X509_set_notAfter X509_set1_notAfter
+#define X509_CRL_get_lastUpdate X509_CRL_get0_lastUpdate
+#define X509_CRL_get_nextUpdate X509_CRL_get0_nextUpdate
+#define X509_CRL_set_lastUpdate X509_CRL_set1_lastUpdate
+#define X509_CRL_set_nextUpdate X509_CRL_set1_nextUpdate
+#endif
 """
diff --git a/src/_cffi_src/openssl/x509_vfy.py b/src/_cffi_src/openssl/x509_vfy.py
index 42da3b1..584b198 100644
--- a/src/_cffi_src/openssl/x509_vfy.py
+++ b/src/_cffi_src/openssl/x509_vfy.py
@@ -338,4 +338,11 @@ void (*X509_STORE_set_get_issuer)(X509_STORE *,
 #else
 static const long Cryptography_HAS_X509_STORE_CTX_GET_ISSUER = 1;
 #endif
+
+#if OPENSSL_API_COMPAT >= 0x10100000L
+#define X509_V_FLAG_CB_ISSUER_CHECK             0x0   /* Deprecated */
+#define X509_STORE_CTX_get_chain X509_STORE_CTX_get0_chain
+#define X509_STORE_CTX_set_chain X509_STORE_CTX_set0_untrusted
+#define X509_STORE_CTX_trusted_stack X509_STORE_CTX_set0_trusted_stack
+#endif
 """
